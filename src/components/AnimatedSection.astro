---
// src/components/AnimatedSection.astro
export interface Props {
  class?: string;
  delay?: number;
}

const { class: className, delay = 0 } = Astro.props;
---

<section class:list={[className, "opacity-0"]} data-animated data-delay={delay}>
  <slot />
</section>

<script>
  const sections = document.querySelectorAll("[data-animated]");
  const observer = new IntersectionObserver(
    (entries) => {
      entries.forEach((entry) => {
        if (entry.isIntersecting) {
          const target = entry.target as HTMLElement;
          const delay = target.getAttribute("data-delay") || "0";
          target.style.animation = `fadeInUp 0.6s ease-out ${delay}ms forwards`;
          observer.unobserve(target);
        }
      });
    },
    { threshold: 0.2 },
  );

  sections.forEach((section) => observer.observe(section));
</script>

<style>
  @keyframes fadeInUp {
    from {
      opacity: 0;
      transform: translateY(20px);
    }
    to {
      opacity: 1;
      transform: translateY(0);
    }
  }
</style>
